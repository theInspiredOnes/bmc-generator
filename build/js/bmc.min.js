angular.module("bmc",[]),angular.module("bmc").service("draggedElementServ",function(){this.draggedElement=null,this.getNewDragElement=function(){return'<div class="post-it"></div>'}}),angular.module("bmc").service("areaServ",function(){var a;a=0,this.areaAdded=function(){return++a},this.areaRemoved=function(){return--a},this.getAreaCount=function(){return a}}),angular.module("bmc").directive("postIt",["draggedElementServ",function(a){return{restrict:"C",scope:!0,template:'<button class="post-it__delete" title="Delete"></button>\n<textarea ng-model="data.text"></textarea>',link:function(b,c){var d,e,f;c.attr("draggable","true"),b.data={},e=function(b){return a.draggedElement=c,c.addClass("post-it--dragged"),b.dataTransfer.setData("Text","")},d=function(){return c.removeClass("post-it--dragged")},f=function(d){return d.stopPropagation&&d.stopPropagation(),b.$emit("area::elementDropped"),c.after(a.draggedElement)},c.bind("dragstart",e),c.bind("dragend",d),c.bind("drop",f)},controller:["$scope","$element",function(a,b){var c;c=function(){return b.remove()},a.$on("postIt::delete",c)}]}}]),angular.module("bmc").directive("postItDelete",function(){return{restrict:"C",template:"&times;",link:function(a,b){var c;c=function(){return a.$emit("postIt::delete")},b.bind("click",c)}}}),angular.module("bmc").directive("area",["areaServ",function(a){return{restrict:"C",scope:!0,template:'<div class="area__head">\n	<input class="area__title" type="text" value="{{title}}"></input>\n	<button class="area__add-element" title="Add new element"></button>\n</div>\n<div class="area__dropzone"></div>',link:function(b,c){var d,e,f,g,h;a.areaAdded(),h=function(a){return a.stopPropagation&&a.stopPropagation(),b.$broadcast("area::appendDraggedElement")},e=function(){return c.addClass("area--dragover")},g=function(a){return a.preventDefault&&a.preventDefault(),a.dataTransfer.dropEffect="move"},f=function(){return c.removeClass("area--dragover")},d=function(){return b.$broadcast("area::appendNewElement")},b.$on("area::elementDropped",f),b.$on("area::addNewElement",d),c.bind("drop",h),c.bind("dragenter",e),c.bind("dragover",g),c.bind("dragleave",f)}}}]),angular.module("bmc").directive("areaTitle",["areaServ",function(a){return{restrict:"C",scope:!0,controller:["$scope","$element",function(b){b.title="Area "+a.getAreaCount()}]}}]),angular.module("bmc").directive("areaAddElement",function(){return{restrict:"C",template:"+",link:function(a,b){var c;c=function(){return a.$emit("area::addNewElement")},b.bind("click",c)}}}),angular.module("bmc").directive("areaDropzone",["draggedElementServ","$compile",function(a,b){return{restrict:"C",scope:!0,link:function(c,d){var e,f;f=function(){return d.append(a.draggedElement),c.$emit("area::elementDropped")},e=function(){var e;return e=b(a.getNewDragElement())(c),d.append(e)},c.$on("area::appendDraggedElement",f),c.$on("area::appendNewElement",e)}}}]);